<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A Grammar for Drift Correcting Water-Quality Data • driftR</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">driftR</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="/index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/driftR.html">Get Started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/ExploringData.html">Exploring Data in R</a>
    </li>
    <li>
      <a href="articles/OtherData.html">Using Data from other Sources</a>
    </li>
    <li>
      <a href="articles/TidyEval.html">Tidy Evaluation in driftR</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/shaughnessyar/driftR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    

    
    
<div class="contents">
<!-- README.md is generated from README.Rmd. Please edit that file -->
<div id="driftr" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#driftr" class="anchor"></a>driftR <img src="reference/figures/logo.png" align="right">
</h1></div>

<p>There are many sources of water quality monitoring data including instruments (ex: YSI instruments) and open source data sets (ex: USGS and NDBC), all of which are susceptible to errors/inaccuracies due to drift. <code>driftR</code> provides a grammar for cleaning and correcting these data in a “tidy”, reproducible manner.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>The easiest way to get <code>driftR</code> is to install it from CRAN:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">"driftR"</span>)</code></pre></div>
<p>You can also install the development version of <code>driftR</code> from Github with <code>devtools</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install.packages("devtools")</span>
devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">"shaughnessyar/driftR"</span>)</code></pre></div>
</div>
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<p>The <code>driftR</code> package implements a series of equations used in <a href="https://www.slu.edu/arts-and-sciences/earth-atmospheric-sciences/faculty/hasenmueller-elizabeth.php">Dr. Elizabeth Hasenmueller’s</a> hydrology and geochemistry research. These equations correct continuous water quality monitoring data for incremental drift that occurs over time after calibration. There are two forms of corrections included in the package - a one-point calibration and a two-point calibration. One-point and two-point calibration values are suited for different types of measurements. The package is currently written for the easiest use with YSI multiparameter Sonde V2 series products.</p>
<p>The figure below illustrates the difference in chloride values between the uncorrected data and the same data with the drift corrections implemented by <code>driftR</code> applied. Note that the uncorrected data drifts to higher values over time. <code>driftR</code> uses calibration data to correct this drift.</p>
<div class="figure">
<img src="reference/figures/chloride_Drop.png">
</div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p>As shown, continuous water quality instruments drift over time, so it becomes necessary to correct the data to maintain accuracy. <code>driftR</code> provides four verbs for applying these corrections in a consistent, reproducible manner: <em>read</em>, <em>factor</em>, <em>correct</em>, and <em>drop</em>. These verbs are designed to be implemented in that order, though there may be multiple applications of <em>correct</em> for a given data set. All of the core functions for <code>driftR</code> have the <code>dr_</code> prefix, making it easy to use them interactively in RStudio.</p>
<div id="basic-use" class="section level3">
<h3 class="hasAnchor">
<a href="#basic-use" class="anchor"></a>Basic Use</h3>
<p>The following example shows a simple workflow for applying these verbs to some hypothetical data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load the driftR package</span>
<span class="kw">library</span>(driftR)

<span class="co"># import data exported from a Sonde </span>
waterTibble &lt;-<span class="st"> </span><span class="kw"><a href="reference/dr_readSonde.html">dr_readSonde</a></span>(<span class="dt">file =</span> <span class="st">"data.csv"</span>, <span class="dt">define =</span> <span class="ot">TRUE</span>)

<span class="co"># calculate correction factor and keep dateTime var</span>
<span class="co"># results stored in new vector corrFac and dateTime</span>
waterTibble &lt;-<span class="st"> </span><span class="kw"><a href="reference/dr_factor.html">dr_factor</a></span>(waterTibble, <span class="dt">corrFactor =</span> corrFac, <span class="dt">dateVar =</span> Date, 
                         <span class="dt">timeVar =</span> Time, <span class="dt">format =</span> <span class="st">"MDY"</span>, <span class="dt">keepDateTime =</span> <span class="ot">FALSE</span>)

<span class="co"># apply one-point calibration to SpCond;</span>
<span class="co"># results stored in new vector SpConde_Corr</span>
waterTibble &lt;-<span class="st"> </span><span class="kw"><a href="reference/dr_correctOne.html">dr_correctOne</a></span>(waterTibble, <span class="dt">sourceVar =</span> SpCond, <span class="dt">cleanVar =</span> SpCond_Corr, 
                             <span class="dt">calVal =</span> <span class="fl">1.07</span>, <span class="dt">calStd =</span> <span class="dv">1</span>, <span class="dt">factorVar =</span> corrFac)

<span class="co"># apply two-point calibration to pH;</span>
<span class="co"># results stored in new vector pH_Corr</span>
waterTibble &lt;-<span class="st"> </span><span class="kw"><a href="reference/dr_correctTwo.html">dr_correctTwo</a></span>(waterTibble, <span class="dt">sourceVar =</span> pH, <span class="dt">cleanVar =</span> pH_Corr, 
                             <span class="dt">calValLow =</span> <span class="fl">7.01</span>, <span class="dt">calStdLow =</span> <span class="dv">7</span>, <span class="dt">calValHigh =</span> <span class="fl">11.8</span>, 
                             <span class="dt">calStdHigh =</span>  <span class="dv">10</span>, <span class="dt">factorVar =</span> corrFac)

<span class="co"># drop observations to account for instrument equilibration</span>
waterTibble &lt;-<span class="st"> </span><span class="kw"><a href="reference/dr_drop.html">dr_drop</a></span>(waterTibble, <span class="dt">head=</span><span class="dv">10</span>, <span class="dt">tail=</span><span class="dv">5</span>)</code></pre></div>
</div>
<div id="use-with" class="section level3">
<h3 class="hasAnchor">
<a href="#use-with" class="anchor"></a>Use with <code>%&gt;%</code>
</h3>
<p>All of the core functions return tibbles (or data frames) and make use of the tidy evaluation pronoun <code>.data</code>, so using them in concert with the pipe (<code>%&gt;%</code>) is straightforward:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load the driftR package</span>
<span class="kw">library</span>(driftR)

<span class="co"># import data exported from a Sonde </span>
waterTibble &lt;-<span class="st"> </span><span class="kw"><a href="reference/dr_readSonde.html">dr_readSonde</a></span>(<span class="dt">file =</span> <span class="st">"sondeData.csv"</span>, <span class="dt">define =</span> <span class="ot">TRUE</span>)

<span class="co"># caclulate correction factors, apply corrections, and drop observations</span>
waterTibble &lt;-<span class="st"> </span>waterTibble <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="reference/dr_factor.html">dr_factor</a></span>(<span class="dt">corrFactor =</span> corrFac, <span class="dt">dateVar =</span> Date, <span class="dt">timeVar =</span> Time, <span class="dt">format =</span> <span class="st">"MDY"</span>, 
            <span class="dt">keepDateTime =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="reference/dr_correctOne.html">dr_correctOne</a></span>(<span class="dt">sourceVar =</span> SpCond, <span class="dt">cleanVar =</span> SpCond_Corr, <span class="dt">calVal =</span> <span class="fl">1.07</span>, 
                <span class="dt">calStd =</span> <span class="dv">1</span>, <span class="dt">factorVar =</span> corrFac) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="reference/dr_correctTwo.html">dr_correctTwo</a></span>(<span class="dt">sourceVar =</span> pH, <span class="dt">cleanVar =</span> pH_Corr, <span class="dt">calValLow =</span> <span class="fl">7.01</span>, <span class="dt">calStdLow =</span> <span class="dv">7</span>, 
                <span class="dt">calValHigh =</span> <span class="fl">11.8</span>, <span class="dt">calStdHigh =</span>  <span class="dv">10</span>, <span class="dt">factorVar =</span> corrFac) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="reference/dr_drop.html">dr_drop</a></span>(<span class="dt">head=</span><span class="dv">10</span>, <span class="dt">tail=</span><span class="dv">5</span>)</code></pre></div>
</div>
</div>
<div id="additional-documentation" class="section level2">
<h2 class="hasAnchor">
<a href="#additional-documentation" class="anchor"></a>Additional Documentation</h2>
<p>See the <a href="https://shaughnessyar.github.io/driftR/">package website</a> for more information on these functions and a <a href="https://shaughnessyar.github.io/driftR/articles/driftR.html">detailed vignette</a> describing how to get started with <code>driftR</code>.</p>
<p>An <a href="https://shaughnessyar.github.io/driftR/articles/TidyEval.html">additional vignette</a> describes <code>driftR</code>’s use of tidy evaluation and how to implement pipes into data cleaning in greater detail. Building on that article, we also <a href="https://shaughnessyar.github.io/driftR/articles/ExploringData.html">provide some introductory examples</a> for how to use <a href="http://tidyr.tidyverse.org"><code>tidyr</code></a>, <a href="http://ggplot2.tidyverse.org"><code>ggplot2</code></a>, and several other <code>R</code> packages to conduct some initial exploratory data analysis of <code>driftR</code> output. Finally, we provide a <a href="https://shaughnessyar.github.io/driftR/articles/OtherData.html">fourth vignette</a> designed for users of non-YSI Sonde multiparameter V2 series instruments who wish to use <code>driftR</code> with their data.</p>
<p>You can also view the help files from within R:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><a href="reference/dr_readSonde.html">?dr_readSonde</a></code></pre></div>
</div>
<div id="want-to-contribute" class="section level2">
<h2 class="hasAnchor">
<a href="#want-to-contribute" class="anchor"></a>Want to Contribute?</h2>
<div id="have-a-concern" class="section level3">
<h3 class="hasAnchor">
<a href="#have-a-concern" class="anchor"></a>Have a Concern?</h3>
<p>If <code>driftR</code> does not seem to be working as advertised, please help us creating a reproducible example, or <a href="https://github.com/tidyverse/reprex"><code>reprex</code></a>, that makes it easy to <a href="https://www.tidyverse.org/help/">get help</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">"reprex"</span>)
<span class="kw">library</span>(<span class="st">"reprex"</span>)</code></pre></div>
<p>After loading the <code>reprex</code> package, copy some code to your clipboard that includes the <code>library()</code> functions, the process you used (ideally simplified), and the functions that are creating issues. Once the material is copied, you can use <code><a href="http://www.rdocumentation.org/packages/reprex/topics/reprex">reprex()</a></code> to format your example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://www.rdocumentation.org/packages/reprex/topics/reprex">reprex</a></span>()</code></pre></div>
<p>Your clipboard will now contain a nicely formatted set of output that you can copy and paste into a GitHub <a href="https://github.com/shaughnessyar/driftR/issues">Issue</a> to describe your problem.</p>
</div>
<div id="adding-dr_read-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-dr_read-functions" class="anchor"></a>Adding <code>dr_read</code> Functions</h3>
<p>We are interested in expanding the built-in capabilities of <code>driftR</code> to read in water quality data from other sources. We are currently working on a function for YSI Exo Multiparameter Sonde output. If you have some sample data (~500 observations are ideal) from another model or brand of instrument and are willing to share it, please reach out to one of the package authors or, better yet, open an <a href="https://github.com/shaughnessyar/driftR/issues">Issue</a>. If you have some <code>R</code> skills and want to write the function yourself, feel free to <a href="https://help.github.com/articles/fork-a-repo/">fork</a> <code>driftR</code>, make your edits, and then open a <a href="https://help.github.com/articles/about-pull-requests/">pull request</a>.</p>
</div>
<div id="contributor-code-of-conduct" class="section level3">
<h3 class="hasAnchor">
<a href="#contributor-code-of-conduct" class="anchor"></a>Contributor Code of Conduct</h3>
<p>Please note that this project is released with a <a href="https://github.com/shaughnessyar/driftR/blob/master/CONDUCT.md">Contributor Code of Conduct</a>. By participating in this project you agree to abide by its terms.</p>
</div>
</div>
<div id="about-the-authors" class="section level2">
<h2 class="hasAnchor">
<a href="#about-the-authors" class="anchor"></a>About the Authors</h2>
<p>Andrew Shaughnessy led the development of this package. He is a senior at <a href="https://www.slu.edu">Saint Louis University</a> majoring in Chemistry and Environmental Science.</p>
<p><a href="https://chris-prener.github.io">Christopher Prener, Ph.D.</a> assisted in the development of this package. He is an Assistant Professor in the Department of Sociology and Anthropology at <a href="https://www.slu.edu/arts-and-sciences/sociology-anthropology/">Saint Louis University</a>. He has a broad interest in computational social science as well as the development of <code>R</code> packages to make research more reproducible and to generalize research code.</p>
<p><a href="https://www.slu.edu/arts-and-sciences/earth-atmospheric-sciences/faculty/hasenmueller-elizabeth.php">Elizabeth Hasenmueller, Ph.D.</a> developed the original equations that this package implements and provided the example data. She is an Assistant Professor in the Department of Earth and Atmospheric Science at <a href="https://www.slu.edu/arts-and-sciences/earth-atmospheric-sciences/">Saint Louis University</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2 class="hasAnchor">
<a href="#sidebar" class="anchor"></a>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/shaughnessyar/driftR">https://​github.com/​shaughnessyar/​driftR</a>
</li>
<li>Report a bug at <br><a href="https://github.com/shaughnessyar/driftR/issues">https://​github.com/​shaughnessyar/​driftR/​issues</a>
</li>
</ul>
<h2>License</h2>
<p><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> + file <a href="LICENSE.html">LICENSE</a></p>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Andrew Shaughnessy <br><small class="roles"> Author, maintainer </small> </li>
<li>
<a href="https://chris-prener.github.io">Christopher Prener</a> <br><small class="roles"> Author </small> </li>
<li>
<a href="https://hasenmuellerlab.weebly.com">Elizabeth Hasenmueller</a> <br><small class="roles"> Author </small> </li>
</ul>
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/shaughnessyar/driftR"><img src="https://travis-ci.org/shaughnessyar/driftR.svg?branch=master" alt="Travis-CI Build Status"></a></li>
<li><a href="https://ci.appveyor.com/project/shaughnessyar/driftR"><img src="https://ci.appveyor.com/api/projects/status/github/shaughnessyar/driftR?branch=master&amp;svg=true" alt="AppVeyor Build Status"></a></li>
<li><a href="https://codecov.io/gh/shaughnessyar/driftR"><img src="https://codecov.io/gh/shaughnessyar/driftR/branch/master/graph/badge.svg" alt="codecov"></a></li>
<li><a href="https://CRAN.R-project.org/package=driftR"><img src="https://www.r-pkg.org/badges/version/driftR" alt="CRAN_Status_Badge"></a></li>
<li><a href="https://zenodo.org/badge/latestdoi/91733812"><img src="https://zenodo.org/badge/91733812.svg" alt="DOI"></a></li>
</ul>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Andrew Shaughnessy, <a href="https://chris-prener.github.io">Christopher Prener</a>, <a href="https://hasenmuellerlab.weebly.com">Elizabeth Hasenmueller</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
